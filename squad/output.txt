[03.02.22 05:33:51] Args: {
    "batch_size": 16,
    "char_emb_file": "./data/char_emb.json",
    "dev_eval_file": "./data/dev_eval.json",
    "dev_record_file": "data/smaller_dev.npz",
    "drop_prob": 0.1,
    "ema_decay": 0.999,
    "eval_steps": 30,
    "gpu_ids": [
        0
    ],
    "hidden_size": 100,
    "l2_wd": 0,
    "load_path": null,
    "lr": 0.5,
    "max_ans_len": 15,
    "max_checkpoints": 5,
    "max_grad_norm": 5.0,
    "maximize_metric": true,
    "metric_name": "F1",
    "name": "train-small-default_name",
    "num_epochs": 1,
    "num_visuals": 10,
    "num_workers": 4,
    "save_dir": "./save/train/train-small-default_name-04",
    "seed": 224,
    "test_eval_file": "./data/test_eval.json",
    "test_record_file": "./data/test.npz",
    "train_eval_file": "./data/train_eval.json",
    "train_record_file": "data/smaller_train.npz",
    "use_squad_v2": true,
    "word_emb_file": "./data/word_emb.json"
}
[03.02.22 05:33:51] Using random seed 224...
[03.02.22 05:33:51] Loading embeddings...
[03.02.22 05:33:56] Building model...
[03.02.22 05:33:59] Saver will maximize F1...
[03.02.22 05:33:59] Building dataset...
[03.02.22 05:33:59] Training...
[03.02.22 05:33:59] Starting epoch 1...
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::zeros         0.00%      58.000us         0.00%      78.000us      78.000us       0.000us         0.00%       0.000us       0.000us           4 b           0 b           0 b           0 b             1  
                                            aten::empty         0.30%       9.816ms         0.46%      15.077ms       9.615us       0.000us         0.00%       0.000us       0.000us          20 b          20 b     677.71 Mb     677.71 Mb          1568  
                                            aten::zero_         0.00%      35.000us        94.31%        3.107s        1.036s       0.000us         0.00%       3.000us       1.000us           0 b           0 b           0 b           0 b             3  
                                       model_training_1         1.04%      34.299ms       100.00%        3.294s        3.294s       0.000us         0.00%      52.437ms      52.437ms          36 b          20 b      87.99 Mb    -845.26 Mb             1  
                                                Scatter         0.01%     294.000us         0.01%     453.000us     113.250us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             4  
                                            aten::chunk         0.00%      87.000us         0.03%     963.000us      35.667us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            27  
                                            aten::split         0.01%     384.000us         0.03%     876.000us      32.444us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            27  
                                           aten::narrow         0.01%     179.000us         0.01%     492.000us       6.740us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            73  
                                            aten::slice         0.02%     651.000us         0.02%     759.000us       7.906us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            96  
                                       aten::as_strided         0.05%       1.802ms         0.05%       1.802ms       1.215us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1483  
                                       aten::zeros_like         0.04%       1.167ms        94.35%        3.108s        1.554s       0.000us         0.00%       3.000us       1.500us           0 b           0 b       4.50 Kb           0 b             2  
                                       aten::empty_like         0.10%       3.277ms         0.26%       8.719ms      16.865us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     390.29 Mb           0 b           517  
                                    aten::empty_strided         0.01%     492.000us         0.02%     815.000us      19.405us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      20.38 Mb      20.38 Mb            42  
                                            aten::fill_         0.00%      74.000us        94.31%        3.106s        1.553s       3.000us         0.01%       3.000us       1.500us           0 b           0 b           0 b           0 b             2  
                                       cudaLaunchKernel        95.13%        3.134s        95.13%        3.134s       1.607ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1950  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       3.000us         0.01%       3.000us       1.500us           0 b           0 b           0 b           0 b             2  
                                               aten::ne         0.00%     151.000us         0.01%     417.000us     104.250us       4.000us         0.01%       8.000us       2.000us           0 b           0 b       2.00 Kb           0 b             4  
                                          aten::resize_         0.03%     969.000us         0.05%       1.784ms       3.611us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      32.84 Mb      32.84 Mb           494  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       4.000us         0.01%       4.000us       2.000us           0 b           0 b           0 b           0 b             2  
                                              aten::sum         0.03%     896.000us         0.13%       4.185ms     167.400us     222.000us         0.42%     232.000us       9.280us           0 b           0 b       5.68 Mb      -4.50 Kb            25  
                                               aten::to         0.00%      62.000us         0.08%       2.798ms     466.333us       0.000us         0.00%      29.000us       4.833us           0 b           0 b      11.00 Kb           0 b             6  
                                            aten::copy_         0.27%       9.058ms         0.56%      18.394ms      37.848us       2.907ms         5.54%       2.907ms       5.981us           0 b           0 b           0 b           0 b           486  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us      10.000us         0.02%      10.000us       5.000us           0 b           0 b           0 b           0 b             2  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      10.000us         0.02%      10.000us       5.000us           0 b           0 b           0 b           0 b             2  
                                        aten::embedding         0.00%     139.000us         0.01%     413.000us     103.250us       0.000us         0.00%      22.000us       5.500us           0 b           0 b       2.73 Mb           0 b             4  
                                          aten::reshape         0.02%     713.000us         0.07%       2.444ms      11.694us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           209  
                                             aten::view         0.13%       4.252ms         0.13%       4.252ms       4.730us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           899  
                                     aten::index_select         0.00%     126.000us         0.01%     221.000us      55.250us      22.000us         0.04%      22.000us       5.500us           0 b           0 b       2.73 Mb       2.73 Mb             4  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      22.000us         0.04%      22.000us       5.500us           0 b           0 b           0 b           0 b             4  
                                           aten::conv2d         0.00%      39.000us         0.11%       3.500ms       1.750ms       0.000us         0.00%     133.000us      66.500us           0 b           0 b       2.88 Mb           0 b             2  
                                      aten::convolution         0.04%       1.455ms         1.76%      58.036ms     283.102us       0.000us         0.00%      41.839ms     204.093us           0 b           0 b     320.34 Mb           0 b           205  
                                     aten::_convolution         0.18%       6.047ms         1.72%      56.581ms     276.005us       0.000us         0.00%      41.839ms     204.093us           0 b           0 b     320.34 Mb           0 b           205  
                                aten::cudnn_convolution         0.37%      12.310ms         0.74%      24.438ms     119.210us      39.597ms        75.51%      39.597ms     193.156us           0 b           0 b     170.68 Mb     161.73 Mb           205  
                                             cudaMalloc         0.32%      10.405ms         0.32%      10.405ms     146.549us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            71  
                                     cudaGetDeviceCount         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                 cudaDeviceGetAttribute         0.00%       4.000us         0.00%       4.000us       0.103us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            39  
                              cudaStreamCreateWithFlags         0.00%      64.000us         0.00%      64.000us       8.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             8  
                       cudaDeviceGetStreamPriorityRange         0.00%       1.000us         0.00%       1.000us       1.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                           cudaStreamCreateWithPriority         0.01%     185.000us         0.01%     185.000us      46.250us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             4  
                                        cudaMemsetAsync         0.01%     281.000us         0.01%     281.000us      11.240us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            25  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      39.000us         0.07%      39.000us       1.560us           0 b           0 b           0 b           0 b            25  
                               cudaEventCreateWithFlags         0.00%      11.000us         0.00%      11.000us       0.234us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            47  
                                          cudaHostAlloc         0.03%       1.020ms         0.03%       1.020ms       1.020ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                               cudaHostGetDevicePointer         0.00%       3.000us         0.00%       3.000us       3.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                               cudaFree         0.00%       3.000us         0.00%       3.000us       0.429us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             7  
                                             cudaMemcpy         0.00%      39.000us         0.00%      39.000us      19.500us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             2  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       3.000us         0.01%       3.000us       1.500us           0 b           0 b           0 b           0 b             2  
                                   cudaFuncSetAttribute         0.00%      14.000us         0.00%      14.000us       0.078us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           180  
                                        cudaEventRecord         0.02%     554.000us         0.02%     554.000us       1.930us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           287  
                                        cudaBindTexture         0.02%     684.000us         0.02%     684.000us       4.385us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           156  
void cudnn::detail::implicit_convolve_sgemm<float, f...         0.00%       0.000us         0.00%       0.000us       0.000us      36.252ms        69.13%      36.252ms     232.385us           0 b           0 b           0 b           0 b           156  
                                      cudaUnbindTexture         0.00%     160.000us         0.00%     160.000us       1.026us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           156  
                                             aten::add_         0.15%       4.986ms         0.23%       7.718ms      32.703us       1.229ms         2.34%       1.229ms       5.208us           0 b           0 b           0 b           0 b           236  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us       1.821ms         3.47%       1.821ms       5.485us           0 b           0 b           0 b           0 b           332  
                                             aten::relu         0.02%     498.000us         0.06%       2.107ms      72.655us       0.000us         0.00%      90.000us       3.103us           0 b           0 b      22.06 Mb           0 b            29  
                                        aten::threshold         0.02%     540.000us         0.05%       1.609ms      55.483us      90.000us         0.17%      90.000us       3.103us           0 b           0 b      22.06 Mb           0 b            29  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      90.000us         0.17%      90.000us       3.103us           0 b           0 b           0 b           0 b            29  
                                              aten::max         0.00%     139.000us         0.01%     408.000us     204.000us      30.000us         0.06%      30.000us      15.000us           0 b           0 b     738.00 Kb           0 b             2  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      30.000us         0.06%      30.000us      15.000us           0 b           0 b           0 b           0 b             2  
                                          aten::permute         0.00%      28.000us         0.00%      31.000us      15.500us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             2  
                                          aten::dropout         0.00%     141.000us         0.01%     435.000us      15.000us       0.000us         0.00%      13.000us       0.448us           0 b           0 b     885.00 Kb    -144.50 Kb            29  
                                   aten::_fused_dropout         0.00%     118.000us         0.01%     294.000us      73.500us      13.000us         0.02%      13.000us       3.250us           0 b           0 b       1.01 Mb           0 b             4  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us      13.000us         0.02%      13.000us       3.250us           0 b           0 b           0 b           0 b             4  
                                              aten::cat         0.00%      96.000us         0.01%     344.000us      68.800us       0.000us         0.00%      46.000us       9.200us           0 b           0 b       5.20 Mb           0 b             5  
                                             aten::_cat         0.00%     116.000us         0.01%     248.000us      49.600us      46.000us         0.09%      46.000us       9.200us           0 b           0 b       5.20 Mb           0 b             5  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us      46.000us         0.09%      46.000us       9.200us           0 b           0 b           0 b           0 b             5  
                                        aten::transpose         0.19%       6.341ms         0.22%       7.168ms      11.450us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           626  
                                           aten::conv1d         0.05%       1.607ms         1.71%      56.182ms     276.759us       0.000us         0.00%      41.706ms     205.448us           0 b           0 b     317.46 Mb           0 b           203  
                                       aten::contiguous         0.12%       3.789ms         0.81%      26.670ms      58.359us       0.000us         0.00%       2.825ms       6.182us           0 b           0 b     374.25 Mb           0 b           457  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us       2.825ms         5.39%       2.825ms       6.182us           0 b           0 b           0 b           0 b           457  
                                        aten::unsqueeze         0.11%       3.672ms         0.13%       4.195ms       9.281us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           452  
cudnn::gemm::computeOffsetsKernel(cudnn::gemm::Compu...         0.00%       0.000us         0.00%       0.000us       0.000us      67.000us         0.13%      67.000us       1.489us           0 b           0 b           0 b           0 b            45  
                volta_scudnn_128x64_relu_interior_nn_v1         0.00%       0.000us         0.00%       0.000us       0.000us       3.067ms         5.85%       3.067ms      68.156us           0 b           0 b           0 b           0 b            45  
                                          aten::squeeze         0.06%       2.127ms         0.07%       2.353ms      11.478us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           205  
                                           aten::linear         0.02%     593.000us         0.32%      10.530ms     188.036us       0.000us         0.00%       3.258ms      58.179us           0 b           0 b      94.93 Mb           0 b            56  
                                                aten::t         0.02%     524.000us         0.03%     876.000us      15.643us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            56  
                                           aten::matmul         0.03%     980.000us         0.26%       8.552ms     144.949us       0.000us         0.00%       3.158ms      53.525us           0 b           0 b      95.42 Mb           0 b            59  
                                               aten::mm         0.08%       2.694ms         0.14%       4.638ms      79.966us       3.006ms         5.73%       3.006ms      51.828us           0 b           0 b      75.76 Mb           0 b            58  
cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFla...         0.00%     121.000us         0.00%     121.000us       2.051us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            59  
                         volta_sgemm_32x32_sliced1x4_tn         0.00%       0.000us         0.00%       0.000us       0.000us      95.000us         0.18%      95.000us       8.636us           0 b           0 b           0 b           0 b            11  
                                     aten::_unsafe_view         0.02%     601.000us         0.02%     728.000us      12.339us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            59  
                                          aten::sigmoid         0.00%     126.000us         0.01%     216.000us      54.000us       9.000us         0.02%       9.000us       2.250us           0 b           0 b     492.00 Kb           0 b             4  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       9.000us         0.02%       9.000us       2.250us           0 b           0 b           0 b           0 b             4  
                                              aten::mul         0.04%       1.333ms         0.08%       2.600ms      61.905us     234.000us         0.45%     234.000us       5.571us           0 b           0 b      20.38 Mb           0 b            42  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      11.000us         0.02%      11.000us       1.375us           0 b           0 b           0 b           0 b             8  
                                             aten::rsub         0.01%     296.000us         0.02%     638.000us      79.750us      13.000us         0.02%      13.000us       1.625us           0 b           0 b     498.50 Kb           0 b             8  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      13.000us         0.02%      13.000us       1.625us           0 b           0 b           0 b           0 b             8  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us      34.000us         0.06%      34.000us       4.857us           0 b           0 b           0 b           0 b             7  
                                              aten::add         0.20%       6.612ms         0.31%      10.109ms      43.017us       1.046ms         1.99%       1.046ms       4.451us           0 b           0 b     186.86 Mb     186.86 Mb           235  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     454.000us         0.87%     454.000us       3.266us           0 b           0 b           0 b           0 b           139  
                                       aten::layer_norm         0.05%       1.612ms         0.97%      32.065ms     159.527us       0.000us         0.00%       2.769ms      13.776us           0 b           0 b     168.32 Mb           0 b           201  
                                aten::native_layer_norm         0.32%      10.651ms         0.92%      30.453ms     151.507us       1.543ms         2.94%       2.769ms      13.776us           0 b           0 b     168.32 Mb    -148.86 Mb           201  
void at::native::(anonymous namespace)::RowwiseMomen...         0.00%       0.000us         0.00%       0.000us       0.000us     878.000us         1.67%     878.000us       4.368us           0 b           0 b           0 b           0 b           201  
void at::native::(anonymous namespace)::LayerNormFor...         0.00%       0.000us         0.00%       0.000us       0.000us     665.000us         1.27%     665.000us       3.308us           0 b           0 b           0 b           0 b           201  
                                      aten::bitwise_not         0.02%     608.000us         0.06%       2.071ms      45.022us      47.000us         0.09%      94.000us       2.043us           0 b           0 b      23.00 Kb           0 b            46  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      47.000us         0.09%      47.000us       2.043us           0 b           0 b           0 b           0 b            23  
                                  volta_sgemm_128x32_tn         0.00%       0.000us         0.00%       0.000us       0.000us      16.000us         0.03%      16.000us      16.000us           0 b           0 b           0 b           0 b             1  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us     183.000us         0.35%     183.000us       7.957us           0 b           0 b           0 b           0 b            23  
                                              aten::bmm         0.05%       1.585ms         0.11%       3.490ms      69.800us       2.111ms         4.03%       2.111ms      42.220us           0 b           0 b      26.91 Mb           0 b            50  
                                  volta_sgemm_128x64_tn         0.00%       0.000us         0.00%       0.000us       0.000us       1.463ms         2.79%       1.463ms      58.520us           0 b           0 b           0 b           0 b            25  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 3.294s
Self CUDA time total: 52.437ms

